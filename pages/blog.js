import Head from 'next/head'
import Link from "next/link"
import styled from 'styled-components'
import { sanityClient } from '../client'
import SubscribeForm from '../components/SubscribeForm'



//STYLES 
 const Wrapper = styled.div`
 background: #3aa1aa;
@media only screen and (max-width: 1024px) {
}
@media only screen and (max-width: 768px) {
  padding: auto;
  margin: 55px 0 0 0;
}
 ` 
 

const Grid = styled.div`
padding-top: 80px;
padding-bottom: 80px;

  display: grid;
  grid-template-columns: repeat(2, 1fr);
  grid-template-rows: 1fr;  
  grid-template-areas: 
  'a b';

@media only screen and (max-width: 1024px) {
  display: grid;
  grid-template-columns: 1fr; 
  grid-template-rows: repeat(2, 1fr);
  grid-template-areas: 
  'b'
  'a';
}
@media only screen and (max-width: 768px) {
}

`
const LeftSide = styled.div`
border-right: solid 2px black;
display: flex;
justify-content: center;
padding-top: 60px;
grid-area: a;
p {
  font-size: 20px;  
}
@media only screen and (max-width: 1024px) {
  border-top: solid 2px black;
}
`
const RightSide = styled.div`
grid-area: b;
padding:90px 50px 180px;
`

const Title = styled.h2`
padding: 25px 0;
font-size: 30px;
`



 const PostTitle = styled.div`
 font-weight: bold;
 font-size: 30px;
 text-decoration: underline;
 color: #007ba5;
 cursor: pointer;
`

const Date = styled.div`

`

const Description = styled.div`
font-size: 20px;
@media only screen and (max-width: 768px) {

}
`

const SubscribeWrapper = styled.div`
height: 380px;

h2 {
  text-align: center;
  padding: 25px;
}
p {
  padding: 20px;
}
@media only screen and (max-width: 768px) {
margin: 25px;
}
`
//END STYLES



 const Projects = ({posts}) => {
   return (
     <>
     <Head>
        <title>Elsa Hovey | Blog</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
       <Wrapper>
     
     <Grid>
      
      <LeftSide>
        <SubscribeWrapper>
        <SubscribeForm />
        </SubscribeWrapper>      
        </LeftSide>

        <RightSide>
          <Title>Recent Posts</Title>
          {posts &&
          posts.map((post, index) => (
            // eslint-disable-next-line react/jsx-key
            <Link href={`post/${post.slug.current}`}>
            <span key={index}>
              <PostTitle>{post.title}</PostTitle>
              <Date>date</Date>
              <Description>{post.description}</Description>
            </span>
            </Link>
          ))
          }
        </RightSide>

       </Grid>
       </Wrapper>
     </>
   )
 }


 export const getServerSideProps = async() => {
    const query = '*[_type == "post"] | order(_createdAt desc)[0..4]'
    const posts = await sanityClient.fetch(query)

    if (!posts.length) {
      return {
        props: {
          posts: [],
        },
      }
    } else {
      return {
      props: {
        posts,
      }
    }
 }
}
  
 

 export default Projects