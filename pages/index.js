import Head from 'next/head'
import { sanityClient, urlFor } from "../client"

import {
  Wrapper,
  HomeLeft,
  HomeRight,
  ToolsTitle,
  WebsiteSection,
  WebsiteGrid,
} from '../components/styles/IndexGrid.styled'

import IndexHeader from '../components/IndexSections/indexHeader'
import ContactInfo from '../components/IndexSections/contact'
import About from '../components/IndexSections/about'  
import Services from '../components/IndexSections/services'  
import Skills from '../components/IndexSections/skills'  



export default function Home({ posts }) {
  return (
    <>
      <Head>
        <title>Elsa Hovey | Development/ Design</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Wrapper>
        <HomeLeft>
          <IndexHeader />
             </HomeLeft>

               <HomeRight> 
                <About />
                <WebsiteSection>
                <div id="portfolio">

                <ToolsTitle>Portfolio</ToolsTitle>  
                     </div>
                          {posts &&
                          posts.map((post, index) => (   
                            <span key={index}>
                           <WebsiteGrid>
                                    <h2>{post.websiteTitle}</h2>
                                    <div>{post.description}</div>
                                        <img
                                        className="img"
                                        src={urlFor(post.websiteImg)}
                                        alt=""
                                        width="250"
                                        height="250"
                                        />
                                    <div>{post.tags}</div>
                            </WebsiteGrid>
                              </span>   
                            ))}
                          </WebsiteSection>
                          <Services />
                           <Skills /> 
                      <div id="contact">
                  <ContactInfo />
                  </div>
         </HomeRight>
         </Wrapper>
    </>
  )
}


export const getServerSideProps = async() => {
  const query = '*[_type == "websites"]'
  const posts = await sanityClient.fetch(query)
  if (!posts.length) {
    return {
      props: {
        posts: [],
      },
    }
  } else {
    return {
      props: {
        posts,
      },
    }
  }
}
 