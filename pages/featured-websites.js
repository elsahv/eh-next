/* eslint-disable @next/next/no-img-element */
import Head from 'next/head'
import { sanityClient, urlFor } from "../client"
import {
Title, 
Wrapper,
Grid,
PostTitles,
Description,
GridSquare,
Tags
} from '../components/styles/websites.styled'




export default function Misc({posts}) {
  return (
    <>  
      <Head>
        <title>Elsa Hovey | Featured Websites</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>     
      
     <Title>Featured Websites</Title>
     <Wrapper> 
       <Grid>
       {posts &&
        posts.map((post, index) => (   
          <span key={index}>
             
            <GridSquare>
            <a href={post.projectLink} target="_blank" rel="noreferrer">
          <PostTitles>{post.title}</PostTitles>
            <Description>{post.description}</Description>
          <img 
               src={urlFor(post.imgUrl)}
               alt="main pic"
               className="image"
              
               />
            <Tags>-{post.tags}</Tags>
            </a>

          </GridSquare>
          </span>
          ))}
          </Grid>
          </Wrapper>
    </>
  )
}


export const getServerSideProps = async () => {
  const query = '*[ _type == "websites"] | order(_createdAt desc)[0..9]'
  const posts = await sanityClient.fetch(query)

  if (!posts.length) {
    return {
      props: {
        posts: [],
      },
    }
  } else {
    return {
      props: {
        posts,
      },
    }
  }
}
 